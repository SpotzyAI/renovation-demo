<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Free Home Renovation Consultation - Florida</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #ffffff;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);
            border: 1px solid #f0f0f0;
            max-width: 500px;
            width: 100%;
            padding: 40px;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .icon {
            font-size: 60px;
            margin-bottom: 15px;
        }

        h1 {
            color: #333;
            font-size: 28px;
            margin-bottom: 10px;
            line-height: 1.3;
        }

        .subtitle {
            color: #666;
            font-size: 16px;
            line-height: 1.5;
        }

        .benefits {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin: 25px 0;
        }

        .benefit-item {
            display: flex;
            align-items: center;
            margin: 12px 0;
            color: #333;
        }

        .benefit-item::before {
            content: "‚úì";
            color: #333;
            font-weight: bold;
            font-size: 20px;
            margin-right: 12px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 600;
            font-size: 14px;
        }

        input[type="tel"],
        input[type="text"] {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .phone-input-wrapper {
            display: flex;
            gap: 10px;
        }

        .country-selector {
            position: relative;
            width: 140px;
        }

        .country-select-button {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            background: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .country-select-button:hover {
            border-color: #333;
        }

        .country-flag {
            font-size: 24px;
            margin-right: 8px;
        }

        .country-code {
            color: #666;
            font-size: 14px;
        }

        .dropdown-arrow {
            margin-left: auto;
            color: #999;
        }

        .country-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            margin-top: 5px;
            max-height: 300px;
            overflow-y: auto;
            display: none;
            z-index: 1000;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .country-dropdown.active {
            display: block;
        }

        .country-search {
            position: sticky;
            top: 0;
            background: white;
            padding: 10px;
            border-bottom: 1px solid #e0e0e0;
        }

        .country-search input {
            width: 100%;
            padding: 10px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
        }

        .country-option {
            padding: 12px 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            transition: background 0.2s ease;
        }

        .country-option:hover {
            background: #f8f9fa;
        }

        .country-option .country-flag {
            margin-right: 12px;
        }

        .country-name {
            flex: 1;
            font-size: 14px;
            color: #333;
        }

        .country-option .country-code {
            font-size: 13px;
        }

        #phone {
            flex: 1;
        }

        input[type="tel"]:focus,
        input[type="text"]:focus {
            outline: none;
            border-color: #333;
            box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.05);
        }

        .submit-btn {
            width: 100%;
            padding: 16px;
            background: #000000;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
            margin-top: 10px;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
            background: #222222;
        }

        .submit-btn:active {
            transform: translateY(0);
        }

        .submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .privacy-text {
            text-align: center;
            font-size: 12px;
            color: #999;
            margin-top: 20px;
            line-height: 1.5;
        }

        .success-message {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .success-message.active {
            display: block;
            animation: slideIn 0.5s ease-out;
        }

        .success-icon {
            font-size: 70px;
            margin-bottom: 20px;
        }

        .success-message h2 {
            color: #333;
            margin-bottom: 15px;
        }

        .success-message p {
            color: #666;
            font-size: 16px;
            line-height: 1.6;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .error-message {
            background: #fee;
            color: #c33;
            padding: 12px;
            border-radius: 8px;
            margin-top: 15px;
            display: none;
            font-size: 14px;
        }

        .error-message.active {
            display: block;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #333;
            color: white;
            padding: 16px 24px;
            border-radius: 10px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            display: none;
            align-items: center;
            gap: 12px;
            z-index: 2000;
            animation: slideInRight 0.3s ease-out;
            max-width: 350px;
        }

        .notification.active {
            display: flex;
        }

        .notification-icon {
            font-size: 24px;
        }

        .notification-text {
            flex: 1;
            font-size: 14px;
            line-height: 1.4;
        }

        @keyframes slideInRight {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .required-indicator {
            color: #e74c3c;
            margin-left: 4px;
        }

        @media (max-width: 600px) {
            .container {
                padding: 30px 20px;
            }

            h1 {
                font-size: 24px;
            }

            .subtitle {
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="formSection">
            <div class="header">
                <div class="icon">üè†</div>
                <h1>Get Your Free Home Renovation Consultation</h1>
                <p class="subtitle">Transform your space with expert guidance. Enter your information and we'll call you back in seconds!</p>
            </div>

            <form id="callbackForm">
                <div class="form-group">
                    <label for="name">Your Name <span class="required-indicator">*</span></label>
                    <input 
                        type="text" 
                        id="name" 
                        name="name" 
                        placeholder="John Smith" 
                        required
                    >
                </div>

                <div class="form-group">
                    <label for="phone">Phone Number <span class="required-indicator">*</span></label>
                    <div class="phone-input-wrapper">
                        <div class="country-selector">
                            <button type="button" class="country-select-button" id="countrySelectBtn">
                                <span>
                                    <span class="country-flag" id="selectedFlag">üá®üáæ</span>
                                    <span class="country-code" id="selectedCode">+357</span>
                                </span>
                                <span class="dropdown-arrow">‚ñº</span>
                            </button>
                            <div class="country-dropdown" id="countryDropdown">
                                <div class="country-search">
                                    <input type="text" id="countrySearch" placeholder="Search country...">
                                </div>
                                <div id="countryList"></div>
                            </div>
                        </div>
                        <input 
                            type="tel" 
                            id="phone" 
                            name="phone" 
                            placeholder="96123456" 
                            required
                        >
                    </div>
                </div>

                <div class="form-group">
                    <label for="address">Property Address <span class="required-indicator">*</span></label>
                    <input 
                        type="text" 
                        id="address" 
                        name="address" 
                        placeholder="123 Main Street, City, FL 33XXX"
                        value="1524 Northeast 182nd Street, North Miami Beach, FL 33162"
                        required
                    >
                </div>

                <button type="submit" class="submit-btn" id="submitBtn">
                    <span id="btnText">üìû Call Me Now</span>
                    <span id="btnLoading" style="display: none;"><span class="loading"></span></span>
                </button>

                <div class="error-message" id="errorMessage"></div>
            </form>

            <p class="privacy-text">
                üîí Your information is secure and will only be used to contact you about your renovation project.
            </p>
        </div>

        <div id="successSection" class="success-message">
            <div class="success-icon">‚úÖ</div>
            <h2>Request Submitted!</h2>
            <p>We're calling you right now! Please answer the phone to speak with our renovation specialist.</p>
            <p style="margin-top: 15px; font-size: 14px; color: #999;">
                Don't see a call? Check your phone for incoming calls.
            </p>
            <button class="submit-btn" id="backBtn" style="margin-top: 25px; background: #666;">
                ‚Üê Back to Form
            </button>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
        <span class="notification-icon">üìû</span>
        <span class="notification-text" id="notificationText"></span>
    </div>

    <script>
        // ========================================
        // COUNTRY DATA WITH FLAGS
        // ========================================
        const countries = [
            { name: "Cyprus", code: "+357", flag: "üá®üáæ" },
            { name: "United States", code: "+1", flag: "üá∫üá∏" },
            { name: "United Kingdom", code: "+44", flag: "üá¨üáß" },
            { name: "Greece", code: "+30", flag: "üá¨üá∑" },
            { name: "Germany", code: "+49", flag: "üá©üá™" },
            { name: "France", code: "+33", flag: "üá´üá∑" },
            { name: "Italy", code: "+39", flag: "üáÆüáπ" },
            { name: "Spain", code: "+34", flag: "üá™üá∏" },
            { name: "Canada", code: "+1", flag: "üá®üá¶" },
            { name: "Australia", code: "+61", flag: "üá¶üá∫" }
        ];

        // ========================================
        // CONFIGURATION FOR YOUR SPOTZY AGENT
        // ========================================
        const SPOTZY_CONFIG = {
            // Spotzy API endpoint for making calls
            apiUrl: 'https://platform.spotzyai.com/api/user/make_call',
            
            
            assistantId: 7018, // 
            
           
            apiKey: '628|Mtyo039FY3usr1NInQqUqMZclnqlFAHV1cQrRZVU27730212'
        };

        // Array of sample Florida addresses for randomization
        const floridaAddresses = [
            "1524 Northeast 182nd Street, North Miami Beach, FL 33162",
            "7856 SW 152nd Avenue, Miami, FL 33193",
            "3421 Northwest 36th Street, Miami, FL 33142",
            "9823 Sunset Drive, Miami, FL 33173",
            "4567 Collins Avenue, Miami Beach, FL 33140",
            "2341 Biscayne Boulevard, Miami, FL 33137",
            "6789 SW 8th Street, Miami, FL 33144",
            "5432 NW 7th Street, Miami, FL 33126",
            "8901 Coral Way, Miami, FL 33165",
            "1234 Ocean Drive, Miami Beach, FL 33139",
            "4810 Southwest 152nd Place, Miami, FL 33185",
            "6831 West 14th Court, Hialeah, FL 33014",
            "15770 Cypress Creek Lane, Wellington, FL 33414",
            "323 Chatham Street, West Palm Beach, FL 33417",
            "7171 Southwest 9th Street, Pembroke Pines, FL 33023"
        ];

        // Set a random Florida address on page load
        window.addEventListener('DOMContentLoaded', function() {
            const addressInput = document.getElementById('address');
            const randomIndex = Math.floor(Math.random() * floridaAddresses.length);
            addressInput.value = floridaAddresses[randomIndex];
        });

        // Country selector elements
        const countrySelectBtn = document.getElementById('countrySelectBtn');
        const countryDropdown = document.getElementById('countryDropdown');
        const countrySearch = document.getElementById('countrySearch');
        const countryList = document.getElementById('countryList');
        const selectedFlag = document.getElementById('selectedFlag');
        const selectedCode = document.getElementById('selectedCode');
        
        // Form elements
        const form = document.getElementById('callbackForm');
        const submitBtn = document.getElementById('submitBtn');
        const btnText = document.getElementById('btnText');
        const btnLoading = document.getElementById('btnLoading');
        const errorMessage = document.getElementById('errorMessage');
        const formSection = document.getElementById('formSection');
        const successSection = document.getElementById('successSection');
        const phoneInput = document.getElementById('phone');

        let selectedCountry = countries[0]; // Default: Cyprus

        // Render country list
        function renderCountries(filter = '') {
            const filteredCountries = countries.filter(country => 
                country.name.toLowerCase().includes(filter.toLowerCase()) ||
                country.code.includes(filter)
            );

            countryList.innerHTML = filteredCountries.map(country => `
                <div class="country-option" data-code="${country.code}" data-flag="${country.flag}" data-name="${country.name}">
                    <span class="country-flag">${country.flag}</span>
                    <span class="country-name">${country.name}</span>
                    <span class="country-code">${country.code}</span>
                </div>
            `).join('');

            // Add click listeners
            document.querySelectorAll('.country-option').forEach(option => {
                option.addEventListener('click', function() {
                    selectedCountry = {
                        name: this.dataset.name,
                        code: this.dataset.code,
                        flag: this.dataset.flag
                    };
                    selectedFlag.textContent = selectedCountry.flag;
                    selectedCode.textContent = selectedCountry.code;
                    countryDropdown.classList.remove('active');
                    countrySearch.value = '';
                    phoneInput.focus();
                });
            });
        }

        // Toggle dropdown
        countrySelectBtn.addEventListener('click', function(e) {
            e.preventDefault();
            countryDropdown.classList.toggle('active');
            if (countryDropdown.classList.contains('active')) {
                countrySearch.focus();
            }
        });

        // Search functionality
        countrySearch.addEventListener('input', function() {
            renderCountries(this.value);
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', function(e) {
            if (!countrySelectBtn.contains(e.target) && !countryDropdown.contains(e.target)) {
                countryDropdown.classList.remove('active');
                countrySearch.value = '';
            }
        });

        // Initialize country list
        renderCountries();

        // Name input - allow only letters and spaces
        const nameInput = document.getElementById('name');
        
        nameInput.addEventListener('input', function(e) {
            // Remove any non-letter characters except spaces
            this.value = this.value.replace(/[^a-zA-Z\s]/g, '');
        });

        // Format phone number as user types (more flexible for international)
        phoneInput.addEventListener('input', function(e) {
            // Only keep numbers
            this.value = this.value.replace(/\D/g, '');
        });

        // Notification function
        function showNotification(message, duration = 5000) {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notificationText');
            
            notificationText.textContent = message;
            notification.classList.add('active');
            
            setTimeout(() => {
                notification.classList.remove('active');
            }, duration);
        }

        // Form submission
        form.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const name = document.getElementById('name').value.trim();
            const phone = phoneInput.value.replace(/\D/g, '');
            const address = document.getElementById('address').value.trim();
            
            // Validation
            if (!name || name.length < 2) {
                showError('Please enter a valid name');
                return;
            }
            
            if (phone.length < 6 || phone.length > 15) {
                showError('Please enter a valid phone number');
                return;
            }

            if (!address || address.length < 10) {
                showError('Please enter a valid address');
                return;
            }

            // Show loading state
            submitBtn.disabled = true;
            btnText.style.display = 'none';
            btnLoading.style.display = 'inline-block';
            errorMessage.classList.remove('active');

            // Show notification immediately
            showNotification('‚è≥ Processing your request... We will call you in a few seconds!', 3000);

            try {
                // Format phone with selected country code
                const fullPhoneNumber = `${selectedCountry.code}${phone}`;
                
                // Create request body with all the variables your agent needs
                const requestBody = {
                    phone_number: fullPhoneNumber,
                    assistant_id: SPOTZY_CONFIG.assistantId,
                    variables: {
                        customer_name: name,
                        property_address: address
                    }
                };

                // Debug logging
                console.log('üîµ API Request Details:');
                console.log('URL:', SPOTZY_CONFIG.apiUrl);
                console.log('Assistant ID:', SPOTZY_CONFIG.assistantId);
                console.log('Phone Number:', fullPhoneNumber);
                console.log('Customer Name:', name);
                console.log('Property Address:', address);
                console.log('Full Request Body:', JSON.stringify(requestBody, null, 2));
                
                const response = await fetch(SPOTZY_CONFIG.apiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${SPOTZY_CONFIG.apiKey}`
                    },
                    body: JSON.stringify(requestBody)
                });

                console.log('üîµ API Response Status:', response.status);
                
                const data = await response.json();
                console.log('üîµ API Response Data:', data);

                if (response.ok) {
                    // Success! Show success message and notification
                    console.log('‚úÖ Call initiated:', data.message);
                    showNotification('‚úÖ Success! We are calling you right now. Please answer your phone!', 7000);
                    
                    // Wait a bit before showing success screen
                    setTimeout(() => {
                        formSection.style.display = 'none';
                        successSection.classList.add('active');
                    }, 1000);
                } else {
                    console.error('‚ùå API Error:', data);
                    throw new Error(data.message || 'Failed to initiate call');
                }
            } catch (error) {
                console.error('‚ùå Error Details:', error);
                showError('Something went wrong. Please try again or call us directly.');
                showNotification('‚ùå Error: Could not initiate call. Please try again.', 5000);
                
                // Reset button state
                submitBtn.disabled = false;
                btnText.style.display = 'inline-block';
                btnLoading.style.display = 'none';
            }
        });

        function showError(message) {
            errorMessage.textContent = message;
            errorMessage.classList.add('active');
            setTimeout(() => {
                errorMessage.classList.remove('active');
            }, 5000);
        }

        // Back button functionality
        document.getElementById('backBtn').addEventListener('click', function() {
            // Hide success section
            successSection.classList.remove('active');
            
            // Show form section
            formSection.style.display = 'block';
            
            // Reset form
            form.reset();
            
            // Set a new random address
            const addressInput = document.getElementById('address');
            const randomIndex = Math.floor(Math.random() * floridaAddresses.length);
            addressInput.value = floridaAddresses[randomIndex];
            
            // Reset button state
            submitBtn.disabled = false;
            btnText.style.display = 'inline-block';
            btnLoading.style.display = 'none';
            
            // Clear any errors
            errorMessage.classList.remove('active');
        });
    </script>
</body>
</html>
